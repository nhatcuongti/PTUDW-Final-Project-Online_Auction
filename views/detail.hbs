{{#section 'js'}}
    <script>
        $('.addItemFavorite').on('click', function (e){
            const id = $(this).data('id');
            $('#txtProID').val(id);
            $('#formAddFavorite').submit();
        });
    </script>
{{/section}}

<form action="/user/favorite/add" method="post" id="formAddFavorite">
    <input type="text" name="id" id="txtProID" hidden>
</form>

{{#each this.proInfo}}
    <div class="row">
        <div class="col-1"></div>
        <div class="col-5">
          <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
            <ol class="carousel-indicators">
              <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
              <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
              <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
            </ol>
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img class="d-block w-100" src="/public/{{_id}}/{{../mainThumb}}" alt="slide">
                </div>

                {{#each ../files}}
                    <div class="carousel-item">
                        <img class="d-block w-100" src="/public/{{../_id}}/{{this}}" alt="slide">
                    </div>
                {{/each}}
            </div>
            <button class="carousel-control-prev" type="button" data-target="#carouselExampleIndicators" data-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="sr-only">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-target="#carouselExampleIndicators" data-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="sr-only">Next</span>
            </button>
          </div>
            {{#if ../historyList}}

            <table class="table table-striped mt-lg-5 border">
                <thead class="thead-dark">
                <tr>
                    <th scope="col">Thời điểm</th>
                    <th scope="col">Người mua</th>
                    <th scope="col">Giá</th>
                </tr>
                </thead>
                <tbody>
                {{#each ../historyList}}
                <tr>
                    <td>{{dateBid}}</td>
                    <td>{{sellerInfo}}</td>
                    <td>{{format_number curProPrice}}</td>
                </tr>
                {{/each}}

            </table>
            {{/if}}


        </div>
        <div class="col-6">
          <p class="h3">{{proName}}</p>
          <p>{{{proDescription}}}</p>
          <div class="row">
            <div class="col-6 mt-3">
            {{#each sellerInfo}}
                <p><strong>Thông tin người bán: {{email}}</strong></p>
            {{/each}}
            </div>
            <div class="col-6 mt-3">
            {{#each curBidderInfo}}
                <p><strong>Thông tin người đấu hiện tại: {{email}}</strong></p>
            {{/each}}
            </div>
          </div>
            {{#if ../auth}}
                <p class="mt-3 has-text-danger font-weight-bold">Giá đấu hiện tại: {{format_number proCurBidPrice}} VNĐ</p>
            {{/if}}
          <p class="mt-3 has-text-danger font-weight-bold">Giá mua ngay: {{format_number proBuyNowPrice}} VNĐ</p>
          <div class="row mt-3">
              {{#if ../auth}}
                    <div class="col-12">
                      <a data-id="{{_id}}" class="addItemFavorite" href="#"><button type="button" class="btn is-info btn-lg btn-block button is-rounded">Thêm vào yêu thích</button></a>
                      <a href="/bid/checkout?id={{_id}}" <button type="button" class="btn is-warning btn-lg btn-block button is-rounded">Đấu giá</button></a>
                      <button type="button" class="btn is-danger btn-lg btn-block button is-rounded">Mua ngay</button>
                    </div>
              {{/if}}
          </div>
        </div>
    </div>
    {{!--
    <div class="row justify-content-center">
        {{#each ../listSimilarity}}
            <div class = "col-2">
                <a style="text-decoration:none" href="/product/{{_id}}">
                    <div class="card">
                        <div class="card-image">
                            <figure class="image is-4by3">
                                <img src="https://bulma.io/images/placeholders/1280x960.png" alt="Placeholder image">
                            </figure>
                        </div>
                        <div class="card-content">
                            <div class="media">
                                <div class="media-content">
                                    <p class="title is-5">{{proName}}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </a>
            </div>
        {{/each}}
    </div>
    --}}
    <div class="container-fluid">
        <div class="row mt-3 d-flex justify-content-center">
            {{#each ../listSimilarity}}
                <a class="col-lg-2 p-3" style="text-decoration:none" href="/product/{{_id}}">
                    <div class="card h-100">
                        <img src="">
                        <div class="card-body">
                            <p class="h4 font-weight-bold">{{proName}}</p>
                        </div>
                        <div class="has-background-grey-lighter">
                            <div class="card-footer justify-content-between">
                                <img src="">
                            </div>
                        </div>
                    </div>
                </a>
            {{/each}}
        </div>
    </div>
{{/each}}